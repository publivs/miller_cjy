BLACK-LITTERMAN模型

理论基础:

Markowitz的Mean-Variance模型利用资产的给定风险来配置最佳化投资组合的利益最大化。存在几个问题:

1. 不直观
2. 组合高集中度
3. 输入过于敏感
4. 估计误差太大

 后续业界的基础资配大部分就是以BL模型为基础进行发展，底层都是基于这一套。

市面上有不同版本的BL模型的版本，Ibbotson Associates公司论文

《A STEP-BY-STEP GUIDE TO THE BLACK-LITTERMAN MODEL Incorporating user-specified confidence levels》

**这个是最规范、参数最详细并且描述最清楚的模型，BL模块代码就以这个论文为基础。**

算法简介:

公式部分:

基础公式:

$\omega = (\lambda\Sigma)^{-1}\mu$                                       1)

Ω 是BL模型中最晦涩难懂的数学参数。而具体如何定义其对角元素

(代表观点的不确定性)是一个没有标准答案的问题。

那么接下来关于如何确定观点中的隐含置信程度并如何转换成直观的用户定义置信程度（0%~100%）来确定 Ω 的值展开讨论，这同时也避免了确定缩放因子 τ 的困扰。

Ω是预测观点的误差阵

$Ω = \begin{bmatrix}   \omega_1&0&0\\0&...&0\\0&0&\omega_k    \end{bmatrix} \ \ \ \ \ \ \ \ 2)$

如1)式所示，$\omega_i$是构成 2)式对角线上的值

隐含置信水平

$ω=τ×p_kΣp_k^′$

这个时候做一个操作，我们把把 Ω 所有的对角线元素都设置为0，这个操作的意义就是，**对于所有 K 个观点，投资者有100%的确信度**，这样做会构建出市场配置权重（基准）关于观点的最大偏离。也就是我们完全相信这些观点，**基于这种100%的信任得到的资产配置权重和市场配置权重作为基准所得到的差值是最大的**。

那么当对于所有观点，我们给予100%的信任度时，

BL模型所得的 E[R100%] 为

$E[R_{100\%}]=\Pi + \tau\Sigma P'(P\tau\Sigma P')^{-1}(Q-P\Pi)$                                                                 3)

再经过公式 1)  的计算得到

$\omega_{100\%}  = (\lambda\Sigma)^{-1} E[R_{100\%}]$

让后我们再来看这个公式

$Tilt_k ≈ (w_{100\%} - w_mkt) * Ck$

$Tilt_k$是关于K个观点的近似偏离度
$C_k$则是第K个观点的信心程度
此外，不考虑其他的观点，这里使用的近似权重为
$w_k,\% ≈ w_mkt + Tilt_k$

具体步骤如下：

1. 对于每个观点k，计算 $E[R_{100 \%}]$
   $E[R_{k,100 \%}] = \Pi + \tau\Sigma P_k'(P_k\tau\Sigma P_k')^{-1}(Q_k-P_k\Pi) $ 其中，

* **$E[R_{k,100 \%}]$** 是在第k个观点中基于100%信心水平的预期回报
* **$P_k$** 系数观点矩阵的第k行
* **$Q_k$** 观点向量的第k个元素

如果所讨论的观点是绝对观点，并且该观点被指定为总回报而不是超额回报，从 $Q_k$ 中减去无风险利率 $r_f$。

1. 计算 $w_{k,100 \%}$
   $w_{k,100 \%} = (\lambda\Sigma)^{-1}E[R_{k,100 \%}]$
2. 计算关于基准的权重最大偏移
   $D_{k,100\%} = w_{k,100 \%}- w_{mkt}$
3. 计算偏移 $Tilt_k$
   $Tilt_k = D_{k,100 \%} * C_k$其中，

* **$Tilt_k$** 是我们所希望的关于第k个观点的偏移
* **$C_k 是 N×1$** 的列向量，被观点涉及的资产设置为用户定义信心水平，其他设置为0

1. 估计目标权重$w_{k,\%}$
   $w_{k,\%} = w_{mkt} + Tilt_k$
2. 找到 $\omega_k$ =，代表第k个观点的不确定程度
   $\min \sum (w_{k, \%} - w_k)^2  \\subject ~to~ \omega > 0 $
3. 其中，

   $w_k = [\lambda \Sigma]^{-1} \Big[(\tau \Sigma)^{-1}+P_k'\omega_k^{-1}P_k \Big]^{-1} \Big[(\tau \Sigma)^{-1}\Pi+P_k'\omega_k^{-1}Q_k \Big]$
5. $E(R_k) = \Big[(\tau \Sigma)^{-1}+P_k'\omega_k^{-1}P_k \Big]^{-1} \Big[(\tau \Sigma)^{-1}\Pi+P_k'\omega_k^{-1}Q_k \Big]$,是根据BL模型对于关于第k个观点的E[R] 的计算公式。
6. 重复步骤1-6，生成 $k×k$的对角 $\Omega$ 矩阵，**在通过新的 $\Omega$ 计算新的组合回报向量** $E[R]$
   *$E[R] = \Big[(\tau \Sigma)^{-1}+P'\Omega^{-1}P \Big]^{-1} \Big[(\tau \Sigma)^{-1}\Pi+P'\Omega^{-1}Q \Big] $*

在上述过程中，缩放因子 $τ$值保持不变，也并不影响 $E[R]$**。尽管步骤相对复杂，但是这个改进方法的最重要的优势在于它能使用户根据更直观的从0%到100%的信心程度来去决定 $Ω$**。用这种新方法来说明

以这种方法确定之前我们看来一个非常抽象的数学参数，使BL模型更容易使用并让更多的投资者从中获益。
